<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="app">
        <!-- show-log : 하위 컴포넌트의 이벤트 명 / printText : 상위 컴포넌트의 메서드명 -->
        <child-component v-on:show-log="printText"></child-component> <!-- (3) show-log 이벤트는 <child-component>에 정의한 v-on:show-log에 전달되고, v-on:show-log의 대상 메서드인 최상위 컴포넌트의 메서드 printText()rk tlfgodshlek. -->
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.2/dist/vue.js"></script>
    <script>

    /*
        하위에서 상위 컴포넌트로 이벤트 전달하기

        이벤트 발생과 수신.

        상위 컴포넌트에서 하위 컴포넌트의 특정 이벤트가 발생하기를 기다리고 있다가
        하위 컴포넌트에서 특정 이벤트가 발생하면
        상위 컴포넌트에서 해당 이벤트를 수신하여 상위 컴포넌트의 메서드를 호출.
    */
    
    /*
        이벤트 발생과 수신 형식

        $emit() 과 v-on: 속성을 사용하여 구현.

        1. 이벤트 발생
        this.$emit('이벤트명');

        2. 이벤트 수신 
        <child-component v-on:이벤트명="상위 컴포넌트의 메서드명"></child-component>
    */

    /*
        $emit()을 호출하면 괄호 안에 정의된 이벤트가 발생한다.
        일반적으로 $emit()을 호출하는 위치는 하위 컴포넌트의 특정 메서드 부분으로
        $emit()을 호출할 때 사용하는 this는 하위 컴포넌트를 가리킨다.

        호출한 이벤트는 하위 컴포넌트를 등록하는 태그(상위 컴포넌트의 template 속성에 위치)에서
        v-on:으로 받는다.
        하위 컴포넌트에서 발생한 이벤트명을 v-on:속성에 저장하고
        속성의 값에 이벤트가 발생했을 때 호출될 상위 컴포넌트의 메서드를 지정한다.
    */
        Vue.component('child-component', {
            template: '<button v-on:click="showLog">show</button>',  // (1) show 버튼을 클릭하면 클릭 이벤트 v-on:click="showLog"에 따라 showLog()메서드가 실행된다.
            methods: {
                showLog: function() {  // (2) showLog() 메서드 안에 this.$emit('show-log')가 실행되면서 show-log 이벤트가 발생한다.
                    this.$emit('show-log');
                }
            }
        });

        new Vue({
            el: '#app',
            data: {
                message: 'Hello Vue! passed from Parent Component'
            },
            methods: {
                printText: function() {  // (4) printText()는 received an event라는 로그를 출력하는 메서드이므로 마지막에 콘솔에 로그가 출력된다.
                    console.log("received an event");
                }
            }
        });

    </script>
    
</body>
</html>